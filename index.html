<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Email Verification</title>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth-compat.js"></script>
</head>
<body>
  <h1 id="status">Verifying your email…</h1>

  <script>
    // Initialize Firebase
    firebase.initializeApp({
      apiKey:      "AIzaSy…",
      authDomain:  "mabskie-47c24.firebaseapp.com",
      projectId:   "mabskie-47c24",
      databaseURL: "https://mabskie-47c24-default-rtdb.firebaseio.com",
    });

    // Grab params
    const params  = new URLSearchParams(window.location.search);
    const mode    = params.get('mode');     // e.g. "verifyEmail" or sometimes "action"
    const oobCode = params.get('oobCode');

    // Only proceed if we got a code
    if ((mode === 'verifyEmail' || mode === 'action') && oobCode) {
      firebase.auth()
        .applyActionCode(oobCode)
        .then(() => {
          document.getElementById('status').textContent =
            '✅ Your email has been verified! You can close this window.';
        })
        .catch(err => {
          console.error(err);
          document.getElementById('status').textContent =
            '❌ Verification failed: ' + err.message;
        });
    } else {
      document.getElementById('status').textContent =
        '⚠️ Sorry, that link is invalid or expired.';
    }
  </script>
</body>
</html>
